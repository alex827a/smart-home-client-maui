<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:res="clr-namespace:SmartHome2.Resources.Strings"
             x:Class="SmartHome2.Views.LoginPage"
             BackgroundColor="{StaticResource Primary}"
             Title="{Binding Source={x:Static res:AppResources.Instance}, Path=Login}">
    <ScrollView>
        <VerticalStackLayout Padding="30" Spacing="20" VerticalOptions="Center">
            
            <!-- Language Selector at top -->
            <HorizontalStackLayout HorizontalOptions="Center" Spacing="10" Margin="0,0,0,20">
                <Button Text="EN" 
                        Command="{Binding ChangeLanguageCommand}"
                        CommandParameter="en"
                        BackgroundColor="Transparent"
                        TextColor="White"
                        BorderColor="White"
                        BorderWidth="1"
                        CornerRadius="5"
                        Padding="15,5"
                        WidthRequest="60"/>
                <Button Text="DE" 
                        Command="{Binding ChangeLanguageCommand}"
                        CommandParameter="de"
                        BackgroundColor="Transparent"
                        TextColor="White"
                        BorderColor="White"
                        BorderWidth="1"
                        CornerRadius="5"
                        Padding="15,5"
                        WidthRequest="60"/>
            </HorizontalStackLayout>
            
            <Image Source="dotnet_bot.png" 
                   HeightRequest="100" 
                   WidthRequest="100"
                   HorizontalOptions="Center"
                   Margin="0,0,0,30"/>
            
            <Label Text="Smart Home Login" 
                   FontSize="32" 
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   TextColor="White"/>
            
            <!-- Guest Mode Info Banner -->
            <Frame BorderColor="LightGreen" 
                   BackgroundColor="#E8F5E9"
                   CornerRadius="10" 
                   Padding="15"
                   IsVisible="{Binding ShowGuestModeInfo}"
                   Margin="0,10,0,10">
                <VerticalStackLayout Spacing="5">
                    <Label Text="ðŸŒ Guest Mode Available" 
                           FontSize="16" 
                           FontAttributes="Bold"
                           TextColor="DarkGreen"
                           HorizontalOptions="Center"/>
                    <Label Text="MQTT unavailable - using SSE fallback" 
                           FontSize="12" 
                           TextColor="Gray"
                           HorizontalOptions="Center"/>
                    <Label Text="Auto-connecting in 2 seconds..." 
                           FontSize="10" 
                           TextColor="Gray"
                           HorizontalOptions="Center"/>
                </VerticalStackLayout>
            </Frame>
            
            <Frame BorderColor="White" CornerRadius="10" Padding="0" HasShadow="False">
                <VerticalStackLayout Padding="20" Spacing="15">
                    
                    <Label Text="{Binding Source={x:Static res:AppResources.Instance}, Path=Username}" FontSize="14" TextColor="{StaticResource Gray600}"/>
                    <Entry x:Name="UsernameEntry" 
                           Text="{Binding Username}"
                           Placeholder="{Binding Source={x:Static res:AppResources.Instance}, Path=EnterUsername}"
                           PlaceholderColor="{StaticResource Gray400}"/>
                    
                    <Label Text="{Binding Source={x:Static res:AppResources.Instance}, Path=Password}" FontSize="14" TextColor="{StaticResource Gray600}"/>
                    <Entry x:Name="PasswordEntry" 
                           Text="{Binding Password}"
                           Placeholder="{Binding Source={x:Static res:AppResources.Instance}, Path=EnterPassword}"
                           IsPassword="True"
                           PlaceholderColor="{StaticResource Gray400}"/>
                    
                    <Button Text="{Binding Source={x:Static res:AppResources.Instance}, Path=Login}" 
                            Command="{Binding LoginCommand}"
                            BackgroundColor="{StaticResource Primary}"
                            TextColor="White"
                            CornerRadius="5"
                            Margin="0,10,0,0"/>
                    
                    <Label Text="{Binding ErrorMessage}" 
                           TextColor="Red" 
                           IsVisible="{Binding HasError}"
                           HorizontalOptions="Center"
                           FontSize="12"/>
                    
                    <ActivityIndicator IsRunning="{Binding IsBusy}" 
                                     IsVisible="{Binding IsBusy}"
                                     Color="{StaticResource Primary}"
                                     HorizontalOptions="Center"/>
                    
                </VerticalStackLayout>
            </Frame>
            
            <StackLayout Orientation="Horizontal" HorizontalOptions="Center" Spacing="5" Margin="0,20,0,0">
                <Label Text="{Binding Source={x:Static res:AppResources.Instance}, Path=QuickLogin}" TextColor="White" FontSize="12"/>
                <Button Text="{Binding Source={x:Static res:AppResources.Instance}, Path=Guest}" 
                        Command="{Binding QuickLoginCommand}"
                        CommandParameter="guest"
                        BackgroundColor="Transparent"
                        TextColor="White"
                        BorderColor="White"
                        BorderWidth="1"
                        CornerRadius="5"
                        Padding="10,5"/>
                <Button Text="{Binding Source={x:Static res:AppResources.Instance}, Path=Admin}" 
                        Command="{Binding QuickLoginCommand}"
                        CommandParameter="admin"
                        BackgroundColor="Transparent"
                        TextColor="White"
                        BorderColor="White"
                        BorderWidth="1"
                        CornerRadius="5"
                        Padding="10,5"/>
            </StackLayout>
            
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>